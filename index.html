<!DOCTYPE html>
<html>
<head>
  <title>Клікер</title>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
    }
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100vh;
    }
    #clicker {
      width: 200px;
      height: 200px;
      background-color: #4CAF50;
      border-radius: 50%;
      cursor: pointer;
    }
    #menu {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: #f2f2f2;
      padding: 10px;
      display: flex;
      justify-content: space-around;
    }
    #menu button {
      background-color: #4CAF50;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Клікер</h1>
    <div id="clicker"></div>
    <div id="stats">
      <p>Кліків: <span id="clickCount">0</span></p>
      <p>Рівень покращення: <span id="upgradeLevel">0</span></p>
      <p>Автоклікер: <span id="autoClicker">Не куплено</span></p>
    </div>
  </div>
  <div id="menu">
    <button id="main">Головне</button>
    <button id="upgrade">Покращення</button>
    <button id="autoClickerBtn">Автоклікер</button>
    <button id="quests">Квести</button>
  </div>

  <script>
    // Конфігурація Firebase
    const firebaseConfig = {
      // Your Firebase configuration goes here
    };
    const app = firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    // Перевірка чи користувач вже зареєстрований
    const isRegistered = localStorage.getItem('registered');

    // Якщо користувач не зареєстрований - показуємо форму реєстрації
    if (!isRegistered) {
      // Форма реєстрації
      const registrationForm = document.createElement('form');
      registrationForm.innerHTML = `
        <input type="text" id="telegramUsername" placeholder="Введіть ім'я користувача Telegram" required>
        <button type="submit">Зареєструватися</button>
      `;
      document.body.appendChild(registrationForm);

      // Обробка форми реєстрації
      registrationForm.addEventListener('submit', (event) => {
        event.preventDefault();
        const telegramUsername = document.getElementById('telegramUsername').value;

        // Зберігаємо дані користувача в кеш браузера
        localStorage.setItem('registered', true);
        localStorage.setItem('telegramUsername', telegramUsername);

        // Відправляємо дані користувача до Firebase
        database.ref('users/' + telegramUsername).set({
          clicks: 0,
          upgradeLevel: 0,
          autoClicker: false,
          quests: []
        });

        // Перенаправлення на головну сторінку
        window.location.href = 'Glowna.html';
      });
    } else {
      // Якщо користувач зареєстрований - отримуємо його дані з Firebase
      const telegramUsername = localStorage.getItem('telegramUsername');
      const userRef = database.ref('users/' + telegramUsername);

      // Отримуємо дані користувача з Firebase
      userRef.on('value', (snapshot) => {
        const userData = snapshot.val();
        document.getElementById('clickCount').textContent = userData.clicks;
        document.getElementById('upgradeLevel').textContent = userData.upgradeLevel;
        document.getElementById('autoClicker').textContent = userData.autoClicker ? 'Куплено' : 'Не куплено';
      });

      // Керування кліками
      let clickCount = parseInt(document.getElementById('clickCount').textContent);
      let upgradeLevel = parseInt(document.getElementById('upgradeLevel').textContent);

      // Функція для оновлення кількості кліків
      function updateClickCount() {
        clickCount++;
        document.getElementById('clickCount').textContent = clickCount;
        userRef.update({ clicks: clickCount });
      }

      // Обробка кліків на клікер
      document.getElementById('clicker').addEventListener('click', updateClickCount);

      // Керування покращенням
      document.getElementById('upgrade').addEventListener('click', () => {
        // Логіка покращення
        upgradeLevel++;
        document.getElementById('upgradeLevel').textContent = upgradeLevel;
        userRef.update({ upgradeLevel: upgradeLevel });
      });

      // Керування автоклікером
      document.getElementById('autoClickerBtn').addEventListener('click', () => {
        // Логіка купівлі автоклікера
        userRef.update({ autoClicker: true });
        // Додайте логіку для запуску автоклікера
      });

      // Керування квестами
      document.getElementById('quests').addEventListener('click', () => {
        // Логіка квестів
        // Відкрийте окреме меню з квестами
        // Додайте логіку для виконання квестів
      });
    }
  </script>
</body>
</html>
